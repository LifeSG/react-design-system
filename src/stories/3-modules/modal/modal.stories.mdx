import { Canvas, Meta, Story, Preview } from "@storybook/addon-docs";
import { useState } from "react";
import { Button, Modal } from "src/components";
import { CustomModalDemo, ModalDemo, StackedModalDemo } from "./doc-elements";

<Meta title="modules/Modal" />

# Modal

A window or pop up that displays over other page contents and provides information or actions
that a user can perform.

> **Note**: Due to the storybook environment, the background of the overlay is scrollable. However in actual, it should not be the case

<Canvas>
    <Story name="Modal" withSource="none">
        <ModalDemo />
    </Story>
</Canvas>

```tsx
export const ModalDemo = (): JSX.Element => {
    const [show, setShow] = useState(false);
    const openModal = () => setShow(true);
    const closeModal = () => setShow(false);
    return (
        <>
            <Button.Default onClick={openModal}>Click to open</Button.Default>
            <Modal.Base show={show} onOverlayClick={closeModal}>
                <Modal.Box onClose={closeModal}>
                    <ModalContent>
                        <span>I am a Modal</span>
                    </ModalContent>
                </Modal.Box>
            </Modal.Base>
        </>
    );
};
```

There are 2 main components that can be used:

-   `Modal.Base` represents the base modal overlay. This is a mandatory component to be used.
-   `Modal.Box` represents the dialog box that comes with a rounded border and a close button.

### Custom modal content body

You can also add a custom modal box to display to the users.

<Preview>
    <CustomModalDemo />
</Preview>

```tsx
export const CustomModalDemo = (): JSX.Element => {
    const [show, setShow] = useState(false);
    const openModal = () => setShow(true);
    const closeModal = () => setShow(false);
    return (
        <>
            <Button.Default onClick={openModal}>
                Open custom modal
            </Button.Default>
            <Modal.Base
                show={show}
                onOverlayClick={closeModal}
                enableOverlayClick={true}
            >
                <CustomComponent>This is a custom component</CustomComponent>
            </Modal.Base>
        </>
    );
};
```

### Stacked modal content body

You can also stack modals by adding the `stacked` prop to the one above.

<Preview>
    <StackedModalDemo />
</Preview>

```tsx
export const StackedModalDemo = (): JSX.Element => {
    const [showFirst, setShowFirst] = useState(false);
    const [showStacked, setShowStacked] = useState(false);
    const handleFirstModalVisibility = (show: boolean) => () => {
        setShowFirst(show);
    };

    const handleStackedModalVisibility = (show: boolean) => () => {
        setShowStacked(show);
    };

    return (
        <div>
            <Button.Default onClick={handleFirstModalVisibility(true)}>
                Click to open
            </Button.Default>
            <Modal.Base
                show={showFirst}
                onOverlayClick={handleFirstModalVisibility(false)}
            >
                <Modal.Box onClose={handleFirstModalVisibility(false)}>
                    <ModalContent>
                        <span>I am the first Modal</span>
                        <br />
                        <br />
                        <Button.Default
                            onClick={handleStackedModalVisibility(true)}
                        >
                            Click to open the stacked modal
                        </Button.Default>
                    </ModalContent>
                </Modal.Box>
            </Modal.Base>
            <Modal.Base
                id="stacked-modal"
                stacked
                show={showStacked}
                onOverlayClick={handleStackedModalVisibility(false)}
            >
                <Modal.Box onClose={handleStackedModalVisibility(false)}>
                    <ModalContent>
                        <span>I am the stacked Modal</span>
                    </ModalContent>
                </Modal.Box>
            </Modal.Base>
        </div>
    );
};
```

## Props

The component also inherits the [HTMLDivElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLDivElement).

| Name                   |                                                        Description                                                        |  Default |
| ---------------------- | :-----------------------------------------------------------------------------------------------------------------------: | -------: |
| **show**`*`            |                                This toggles the visibility of the `Modal` <br />`boolean`                                 |        - |
| **id**                 |                                    The unique identifier of the `Modal` <br />`string`                                    |        - |
| **rootComponentId**    |                      The unique identifier of root element to inject the `Modal` into <br />`string`                      |        - |
| **animationFrom**      |              The animation direction of which the `Modal` will appear <br />`top`, `bottom`, `left`, `right`              | `bottom` |
| **enableOverlayClick** |                This toggles whether the modal can be dismissed by clicking on the overlay <br />`boolean`                 |   `true` |
| **stacked**            |                 This indicates if the `Modal` is to be stacked on top of another `Modal` <br />`boolean`                  |  `false` |
| **onOverlayClick**     | The callback when the overlay is being clicked on. Will be triggered if `enableOverlayClick` is `true` <br />`() => void` |        - |

> Modals are injected to the root levels of the web structure. As such the `rootComponentId` is used to indicate the root level element. Not specifying the root element will make `<body>` the root element.

## `Modal.Box`

This component holds the dialog box component.

> The `Modal.Box` does not come with a scrollable container, hence the onus is on the child element to possess the scrollable behaviour.

```tsx
<Modal.Box onClose={closeModal}>
    <ScrollableContent>
        <span>I am a Modal</span>
    </ScrollableContent>
</Modal.Box>
```

### Props

The component also inherits the [HTMLDivElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLDivElement).

| Name                |                                                    Description                                                     | Default |
| ------------------- | :----------------------------------------------------------------------------------------------------------------: | ------: |
| **showCloseButton** |                           This toggles the visibility of the close button<br />`boolean`                           |  `true` |
| **onClose**         | The callback when the close button is clicked. Will be triggered if the close button is visible <br />`() => void` |       - |

```

```
