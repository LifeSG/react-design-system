import { useState, useRef } from "react";
import { Canvas, Meta, Story } from "@storybook/addon-docs";
import {
    FullWidthStoryContainer,
    Secondary,
    Heading3,
    Title,
    StoryContainer,
} from "../storybook-common";
import { Button } from "src/button";
import { Modal } from "/src/modal";
import { Text } from "src/text";
import { CountdownTimer } from "src/countdown-timer";
import { CountdownView, NotifyModal } from "./doc-elements.tsx";
import { PropsTable } from "./props-table";

<Meta title="Modules/CountdownTimer" component={CountdownTimer} />

<Title>Countdown Timer</Title>

<Secondary>Overview</Secondary>

Displays a countdown timer.

```tsx
import { CountdownTimer } from "@lifesg/react-design-system/countdown-timer";
```

<Canvas>
    <Story name="CountdownTimer">
        <CountdownTimer
            show
            timer={15}
            notifyTimer={10}
            fixed={false} /* For storybook purposes */
            onNotify={() => console.log("Warning")}
            onFinish={() => console.log("Complete")}
            onTick={(seconds) => console.log(`Seconds remaining: ${seconds}`)}
        />
    </Story>
</Canvas>

<Heading3>Scroll behaviour</Heading3>

The countdown timer is fixed to the top when scrolled out of view. By default it is aligned right, relative to its original position. It can also be aligned left.

> Note: Due to the storybook environment, the scroll detection may not be accurate.
> [View this canvas in a new tab](./iframe.html?args=&id=modules-countdowntimer--scroll-behaviour&viewMode=story) for best results.

<Canvas>
    <Story
        name="Scroll behaviour"
        parameters={{
            layout: "fullscreen",
            docs: { inlineStories: false, iframeHeight: 500 },
        }}
    >
        {() => {
            const [showTimer, setShowTimer] = useState(false);
            return (
                <CountdownView>
                    <Button.Default onClick={() => setShowTimer(true)}>
                        Start
                    </Button.Default>
                    <CountdownTimer
                        show={showTimer}
                        timer={15}
                        notifyTimer={10}
                    />
                </CountdownView>
            );
        }}
    </Story>
</Canvas>

<Heading3>Advanced positioning</Heading3>

The position can also be customised via the offset props.

> Note: Due to the storybook environment, the scroll detection may not be accurate.
> View [this canvas in a new tab](./iframe.html?args=&id=modules-countdowntimer--scroll-behaviour&viewMode=story) for best results.

<Canvas>
    <Story
        name="Custom offset"
        parameters={{
            layout: "fullscreen",
            docs: { inlineStories: false, iframeHeight: 500 },
        }}
    >
        {() => {
            const [showTimer, setShowTimer] = useState(false);
            return (
                <CountdownView>
                    <Button.Default onClick={() => setShowTimer(true)}>
                        Start
                    </Button.Default>
                    <CountdownTimer
                        show={showTimer}
                        timer={15}
                        notifyTimer={10}
                        offset={{ top: 16 }}
                        mobileOffset={{ top: 0 }}
                    />
                </CountdownView>
            );
        }}
    </Story>
</Canvas>

<Secondary>Component API</Secondary>

<PropsTable />
