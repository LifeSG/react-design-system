import { Canvas, Meta, Preview, Story } from "@storybook/addon-docs";
import { useState } from "react";
import { PhoneNumberInput } from "src/phone-number-input";
import { Form } from "src/form";
import {
    Heading3,
    Heading4,
    Secondary,
    StoryContainer,
    Title,
} from "../../storybook-common";
import { Container } from "../shared-doc-elements";
import { PropsTable } from "./props-table";

<Meta title="Form/PhoneNumberInput" component={Form.PhoneNumberInput} />

<Title>Form.PhoneNumberInput</Title>

<Secondary>Overview</Secondary>

The field that allows a user to enter a phone number value.

```tsx
import { Form } from "@lifesg/react-design-system/form";
```

**Important note**: This component currently does not do phone number value validation

<Canvas>
    <Story name="PhoneNumberInput">
        {() => {
            const [value1, setValue1] = useState({
                number: "",
                countryCode: "",
            });
            const handleClear = () => {
                setValue1((prevState) => ({ ...prevState, number: "" }));
            };
            return (
                <StoryContainer>
                    <Container>
                        <Form.PhoneNumberInput
                            label="This is the default state (allow clear enabled)"
                            placeholder="Enter phone number"
                            allowClear
                            value={value1}
                            onChange={(value) => setValue1(value)}
                            onClear={handleClear}
                        />
                        <Form.PhoneNumberInput
                            label="This has searchable option"
                            placeholder="Enter phone number"
                            enableSearch
                        />
                        <Form.PhoneNumberInput
                            label="This is the disabled state"
                            disabled
                            placeholder="Enter phone number"
                        />
                        <Form.PhoneNumberInput
                            label="This is the readonly state"
                            placeholder="Enter phone number"
                            value={{ number: "91234567", countryCode: "+65" }}
                            readOnly
                        />
                        <Form.PhoneNumberInput
                            label="This is the error state"
                            errorMessage="Mobile number is required"
                            placeholder="Enter phone number"
                        />
                    </Container>
                </StoryContainer>
            );
        }}
    </Story>
</Canvas>

<Heading3>Fixed country</Heading3>

In the case where you do not wish to allow the user to select from the country options list,
you can pass the prop `fixedCountry` to restrict input to only that country code.

<Preview>
    <Story name="Fixed country">
        <StoryContainer>
            <Form.PhoneNumberInput
                label="This has a fixed country code"
                placeholder="Enter phone number"
                value={{
                    countryCode: "+65",
                }}
                fixedCountry
            />
        </StoryContainer>
    </Story>
</Preview>

<Heading3>Using the field as a standalone</Heading3>

In the case that you require the phone number input field as a standalone, you can do this.

```tsx
import { PhoneNumberInput } from "@lifesg/react-design-system/phone-number-input";
```

<Preview>
    <Story name="Standalone usage">
        {() => {
            const [value, setValue] = useState({
                number: "",
                countryCode: "65",
            });
            const handleClear = () => {
                setValue((prevState) => ({ ...prevState, number: "" }));
            };
            return (
                <StoryContainer>
                    <Container>
                        <PhoneNumberInput
                            label="This is the phone number input"
                            placeholder="Enter phone number"
                            allowClear={true}
                            enableSearch={true}
                            value={value}
                            onChange={(value) => setValue(value)}
                            onClear={handleClear}
                        />
                    </Container>
                </StoryContainer>
            );
        }}
    </Story>
</Preview>

<Secondary>Component API</Secondary>

<PropsTable />
