import { GearIcon } from "@lifesg/react-icons/gear";
import { Canvas, Meta, Story } from "@storybook/addon-docs";
import { useState } from "react";
import { IconButton } from "src/icon-button";
import { Navbar } from "src/navbar";
import {
    Heading3,
    Heading4,
    Secondary,
    StoryContainer,
    Title,
} from "../storybook-common";
import { PropsTable } from "./props-table";

<Meta title="Modules/Navbar" component={Navbar} />

<Title>Navbar</Title>

<Secondary>Overview</Secondary>

A component that displays navigation links, action buttons and a brand at the top of the web page.

```tsx
import { Navbar } from "@lifesg/react-design-system/navbar";
```

<Canvas>
    <Story name="Navbar">
        {() => {
            const [selected, setSelected] = useState("home");
            return (
                <Navbar
                    items={{
                        desktop: [
                            {
                                id: "home",
                                children: "Home",
                                onClick: () => {
                                    setSelected("home");
                                },
                            },
                            {
                                id: "guides",
                                children: "Guides",
                                onClick: () => {
                                    setSelected("guides");
                                },
                            },
                            {
                                id: "lifesg-app",
                                children: "LifeSG app",
                                onClick: () => {
                                    setSelected("lifesg-app");
                                },
                            },
                            {
                                id: "blog",
                                children: "Blog",
                                onClick: () => {
                                    setSelected("blog");
                                },
                            },
                        ],
                        mobile: [
                            {
                                id: "home-mobile",
                                children: "Home",
                                href: "https://www.life.gov.sg",
                            },
                            {
                                id: "guides-mobile",
                                children: "Guides",
                                href: "https://www.life.gov.sg",
                            },
                            {
                                id: "lifesg-app-mobile",
                                children: "LifeSG app",
                                href: "https://www.life.gov.sg",
                            },
                            {
                                id: "blog-mobile",
                                children: "Blog",
                                href: "https://www.life.gov.sg/blog",
                            },
                        ],
                    }}
                    actionButtons={{
                        desktop: [{ type: "download" }],
                    }}
                    selectedId={selected}
                    fixed={false} /* For storybook purposes */
                />
            );
        }}
    </Story>
</Canvas>

<Heading3>Anatomy</Heading3>

The Navbar comes with 3 main components:

-   Masthead
-   Brand
-   Navigation links

In the mobile viewports, the navigation links are presented in a drawer and is triggered by clicking on the menu icon button.

> **NOTE**: The `Navbar` drawer dismissal animation takes **550ms**. If you are intending to perform scrolling effects in page after a selection in the drawer, you can add a timeout before performing the scrolling

<br />

<Secondary>Usage examples</Secondary>

<Heading3>Single action button</Heading3>

This is a common use case among web apps where it requires a Logout button on the navigation bar.

<Canvas>
    <Story name="Single action button">
        <Navbar
            items={{
                desktop: [],
                mobile: [],
            }}
            actionButtons={{
                desktop: [
                    {
                        type: "button",
                        args: {
                            styleType: "secondary",
                            children: "Logout",
                        },
                    },
                ],
            }}
            selectedId="home"
            fixed={false} /* For storybook purposes */
        />
    </Story>
</Canvas>

<Heading3>Multiple action buttons</Heading3>

> **Note**: In the mobile view, the `download` action button will always be positioned last

<Canvas>
    <Story name="Multiple action buttons">
        <Navbar
            items={{
                desktop: [
                    {
                        id: "home",
                        children: "Home",
                        href: "https://www.life.gov.sg",
                        target: "_blank",
                    },
                    {
                        id: "guides",
                        children: "Guides",
                        href: "https://www.life.gov.sg",
                    },
                    {
                        id: "lifesg-app",
                        children: "LifeSG app",
                        href: "https://www.life.gov.sg",
                    },
                ],
            }}
            actionButtons={{
                desktop: [
                    {
                        type: "button",
                        args: {
                            styleType: "link",
                            children: "FAQ",
                        },
                    },
                    {
                        type: "button",
                        args: {
                            styleType: "secondary",
                            children: "Logout",
                        },
                    },
                    {
                        type: "download",
                    },
                ],
                mobile: [
                    {
                        type: "download",
                    },
                    {
                        type: "button",
                        args: {
                            styleType: "secondary",
                            children: "Logout",
                        },
                    },
                    {
                        type: "button",
                        args: {
                            styleType: "link",
                            children: "FAQ",
                        },
                    },
                ],
            }}
            selectedId="home"
            fixed={false} /* For storybook purposes */
        />
    </Story>
</Canvas>

<Heading3>Custom component action buttons</Heading3>

You can also choose to render a custom component of your choice as an action button.

<Canvas>
    <Story name="Custom action buttons">
        <Navbar
            items={{
                desktop: [
                    {
                        id: "home",
                        children: "Home",
                        href: "https://www.life.gov.sg",
                        target: "_blank",
                    },
                    {
                        id: "guides",
                        children: "Guides",
                        href: "https://www.life.gov.sg",
                    },
                    {
                        id: "lifesg-app",
                        children: "LifeSG app",
                        href: "https://www.life.gov.sg",
                    },
                ],
            }}
            actionButtons={{
                desktop: [
                    {
                        type: "component",
                        args: {
                            render: (
                                <IconButton>
                                    <GearIcon
                                        style={{
                                            width: "1.25rem",
                                            height: "1.25rem",
                                        }}
                                    />
                                </IconButton>
                            ),
                        },
                    },
                ],
            }}
            selectedId="home"
            fixed={false} /* For storybook purposes */
        />
    </Story>
</Canvas>

<Heading3>Prevent dismissal of drawer on specific actions</Heading3>

In this example, we are preventing the drawer's dismissal on the brand logo click. We'll make use of
the `blockDrawerDismissalMethods` prop to do just that.

> **Note**: You will need to view this in a mobile or tablet viewport to see the interaction

<Canvas>
    <Story name="Prevent drawer dismissal">
        <Navbar
            items={{
                desktop: [
                    {
                        id: "home",
                        children: "Home",
                        href: "https://www.life.gov.sg",
                        target: "_blank",
                    },
                    {
                        id: "guides",
                        children: "Guides",
                        href: "https://www.life.gov.sg",
                    },
                    {
                        id: "lifesg-app",
                        children: "LifeSG app",
                        href: "https://www.life.gov.sg",
                    },
                ],
            }}
            actionButtons={{
                desktop: [
                    {
                        type: "download",
                    },
                ],
            }}
            selectedId="home"
            fixed={false} /* For storybook purposes */
            blockDrawerDismissalMethods={["brand-click"]}
        />
    </Story>
</Canvas>

<Heading3>Sub menu</Heading3>

A sub menu is shown if the selected nav item has sublinks.

<Canvas>
    <Story name="Sub menu">
        {() => {
            const [selected, setSelected] = useState("lifesg1");
            return (
                <Navbar
                    items={{
                        desktop: [
                            {
                                id: "home",
                                children: "Home",
                            },
                            {
                                id: "guides",
                                children: "Guides",
                                subMenu: [
                                    {
                                        id: "guides1",
                                        children:
                                            "Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1 Sub Guides 1",
                                        href: "https://www.life.gov.sg",
                                    },
                                    {
                                        id: "guides2",
                                        children: "Sub Guides 2",
                                        href: "https://www.life.gov.sg",
                                    },
                                    {
                                        id: "guides3",
                                        children: "Sub Guides 3",
                                        href: "https://www.life.gov.sg",
                                    },
                                ],
                            },
                            {
                                id: "lifesg-app",
                                children: "LifeSG app",
                                subMenu: [
                                    {
                                        id: "lifesg1",
                                        children: "Sub LifeSG 1",
                                        href: "https://www.life.gov.sg",
                                    },
                                    {
                                        id: "lifesg2",
                                        children: "Sub LifeSG 2",
                                        href: "https://www.life.gov.sg",
                                    },
                                    {
                                        id: "lifesg3",
                                        children: "Sub LifeSG 3",
                                        href: "https://www.life.gov.sg",
                                    },
                                    {
                                        id: "lifesg4",
                                        children: "Sub LifeSG 4",
                                        href: "https://www.life.gov.sg",
                                    },
                                ],
                            },
                        ],
                    }}
                    actionButtons={{
                        desktop: [
                            {
                                type: "button",
                                args: {
                                    styleType: "link",
                                    children: "FAQ",
                                },
                            },
                            {
                                type: "button",
                                args: {
                                    styleType: "secondary",
                                    children: "Logout",
                                },
                            },
                            {
                                type: "download",
                            },
                        ],
                    }}
                    selectedId={selected}
                    fixed={false} /* For storybook purposes */
                    onItemClick={(item) => {
                        setSelected(item.id);
                    }}
                />
            );
        }}
    </Story>
</Canvas>

<Heading3>Secondary branding</Heading3>

In this example, a co-brand is displayed next to the primary brand.

<Canvas>
    <Story name="Secondary branding">
        <Navbar
            items={{
                desktop: [
                    {
                        id: "home",
                        children: "Home",
                        onClick: () => {
                            setSelected("home");
                        },
                    },
                    {
                        id: "guides",
                        children: "Guides",
                        onClick: () => {
                            setSelected("guides");
                        },
                    },
                    {
                        id: "lifesg-app",
                        children: "LifeSG app",
                        onClick: () => {
                            setSelected("lifesg-app");
                        },
                    },
                ],
            }}
            actionButtons={{
                desktop: [
                    {
                        type: "button",
                        args: {
                            styleType: "link",
                            children: "FAQ",
                        },
                    },
                    {
                        type: "button",
                        args: {
                            styleType: "secondary",
                            children: "Logout",
                        },
                    },
                    {
                        type: "download",
                    },
                ],
            }}
            fixed={false} /* For storybook purposes */
            resources={{
                secondary: {
                    brandName: "OneService",
                    logoSrc:
                        "https://www.life.gov.sg/img/one-service/os-logo.png",
                },
            }}
            onBrandClick={(type) => {
                alert("Clicked on " + type + " brand");
            }}
        />
    </Story>
</Canvas>

<Heading3>Hidden masthead</Heading3>

In this example, the masthead is hidden.

<Canvas>
    <Story name="Hidden masthead">
        <Navbar
            items={{
                desktop: [
                    {
                        id: "home",
                        children: "Home",
                        onClick: () => {
                            setSelected("home");
                        },
                    },
                    {
                        id: "guides",
                        children: "Guides",
                        onClick: () => {
                            setSelected("guides");
                        },
                    },
                    {
                        id: "lifesg-app",
                        children: "LifeSG app",
                        onClick: () => {
                            setSelected("lifesg-app");
                        },
                    },
                ],
            }}
            actionButtons={{
                desktop: [
                    {
                        type: "button",
                        args: {
                            styleType: "link",
                            children: "FAQ",
                        },
                    },
                    {
                        type: "button",
                        args: {
                            styleType: "secondary",
                            children: "Logout",
                        },
                    },
                    {
                        type: "download",
                    },
                ],
            }}
            fixed={false} /* For storybook purposes */
            masthead={false}
        />
    </Story>
</Canvas>

<Secondary>Troubleshooting</Secondary>

> The component also uses a custom script. Should you encounter a content security
> policy error, do add this script in the `scriptSrc` blob.
> https://cdn.jsdelivr.net/npm/@govtechsg/sgds-web-component/Masthead/index.js

<br />

<Secondary>Component API</Secondary>

<PropsTable />
